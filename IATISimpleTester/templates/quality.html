{% extends "base.html" %}
{% from 'partials/_totaliser.html' import totaliser %}

{% block body %}

<div class="row" style="padding-bottom: 20px;">
  <form method="get">
    <div class="row">
      <div class="col-lg-6">
        {% for k, v in params.items() %}
          {% if k not in ['uuid', 'filter'] %}
          <input type="hidden" name="{{ k }}" value="{{ v }}" />
          {% endif %}
        {% endfor %}
        <div class="input-group">
          <select class="form-control" name="filter">
            <option value="true"
            {%- if not params['filter'] == 'false' %} selected="selected"
            {%- endif -%}
            >Current activities ({{ total_filtered_activities }} activities)</option>
            <option value="false"
            {%- if params['filter'] == 'false' %} selected="selected"
            {%- endif -%}
            >All activities ({{ total_activities }} activities)</option>
          </select>
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go!</button>
          </span>
        </div><!-- /input-group -->
      </div><!-- /.col-lg-6 -->
    </div><!-- /.row -->
  </form>
</div>

<div class="row">
  {% if params['component'] %}
  <div class="panel panel-primary">
  <div class="panel-heading"><h3 class="panel-title">{{ params['component'] }}</h3></div>
  <div class="panel-body">
  {% endif %}

  {% for test_name, result_dict in results.items() %}
  <div class="col-sm-6 quality-panels">
      <div class="panel panel-primary">
        <div class="panel-heading"><h3 class="panel-title"><a href="{{ url_for('package_quality', **dict(params, component=test_name)) }}">{{ test_name }}</a>
        <a href="#"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span></a></h3></div>
        <div class="panel-body">
          {{ totaliser(result_dict) }}
        </div>
      </div>
  </div>
  {% endfor %}

  {% if params['component'] %}
  </div></div>
  {% endif %}

</div>
{% endblock %}
